# 三月测试服务器基本信息

跳板机ip：59.110.218.15

Mac的ip：10.102.22.44

Mac的SSH连接host名：mac.marchsoft.cn

Mac的SSH连接端口：2020

Mac用户：mac-server

Mac密码：Marchsoft@2020

Mac的frp管理页面：http://mac.marchsoft.cn:82/static/#/proxies/http

# docker常用服务安装

## nginx

失败：

mac下docker不能使用host模式

```shell
docker run -it --name nginx --net host -v /Users/mac-server/Desktop/project:/var/www/html -v /Users/mac-server/Desktop/nginx:/nginx_conf -d nginx  
```



成功：


```shell
docker run -it --name nginx -p 80:80 -p 7000-8000:7000-8000  -v /Users/mac-server/Desktop/project:/var/www/html -v /Users/mac-server/Desktop/nginx:/nginx_conf -d nginx 

mv /etc/nginx/conf.d /nginx_conf
ln -s /nginx_conf/conf.d /etc/nginx

mv /etc/nginx/nginx.conf /nginx_conf
ln -s /nginx_conf/nginx.conf /etc/nginx
```



## mysql

地址：59.110.218.15:8001

用户：root

密码：Marchsoft@test

```shell
docker run -p 3306:3306 --name mysql -v /Users/mac-server/Desktop/mysql/conf:/etc/mysql/conf.d -v /Users/mac-server/Desktop/mysql/logs:/logs -v /Users/mac-server/Desktop/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=Marchsoft@test -d mysql
```

## rabbitmq

地址：59.110.218.15:8003

用户：marchsoft

密码：Marchsoft@test

```shell
docker run -d --name rabbitmq -p 5672:5672 -p 15672:15672 -v /Users/mac-server/Desktop/rabbitmq:/var/lib/rabbitmq --hostname myRabbit -e RABBITMQ_DEFAULT_USER=marchsoft -e RABBITMQ_DEFAULT_PASS=Marchsoft@test rabbitmq:management
```



## redis

地址：59.110.218.15:8002

密码：Marchsoft@test

```shell
docker run -p 6379:6379 --name redis -v /Users/mac-server/Desktop/redis/redis.conf:/etc/redis/redis.conf  -v /Users/mac-server/Desktop/redis/data:/data -d redis redis-server /etc/redis/redis.conf --appendonly yes
```



## centos_git_nvm

运行/Users/mac-server/Desktop/portal.sh脚本

执行命令初始化容器：

```shell
bash portal.sh init
```




# 规约

1.7000-8000端口，用于项目测试，及nginx容器端口

2.8001-8100端口，用于第三方服务，类似于mysql、redis这种....

3.`/Users/marchsoft/frp/frp/frpc.ini`放置frp域名及外网访问服务

```shell
[common]
server_addr = 59.110.218.15
server_port = 7000
token = marchsoft@2020

[mysql]
type = tcp
local_ip = 127.0.0.1
local_port = 3306
remote_port = 8001

[redis]
type = tcp
local_ip = 127.0.0.1
local_port = 6379
remote_port = 8002

[rabbitmq]
type = tcp
local_ip = 127.0.0.1
local_port = 5672
remote_port = 8003

[web]
type = http
local_port = 80
custom_domains = test1.lzyjykj.cn

[web01]
type = http
local_port = 7002
custom_domains = test2.lzyjykj.cn

[web03]
type = http
local_port = 7003
custom_domains = test3.lzyjykj.cn

```
3.第三方服务使用跳板机的ip（59.110.218.15）进行访问。

# 常用命令

```shell
# 查看frp进程情况
ps -ef | grep frp
# frp服务启动脚本
bash /Users/marchsoft/startup.sh
```

centos:centos7