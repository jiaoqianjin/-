# 问题



## 1. 批量修改

批量处理多sql语句执行时，用 ；隔开。需要添加“&allowMultiQueries=true”

“allowMultiQueries=true”的作用：
1.可以在sql语句后携带分号，实现多语句执行。
2.可以执行批处理，同时发出多个SQL语句。

## 2. 微信公众号开发接入wx_java

### 1.  申请测试公众号
测试号可以体验并测试微信公众平台所有的高级接口，如果是自己的个人微信公众号有很多的接口都用不了，所以推荐大家使用测试号，[测试号申请](http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login)
![个人公众号权限低](https://img-blog.csdnimg.cn/20200823091633261.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDQ5MTkyNw==,size_16,color_FFFFFF,t_70#pic_center)
测试号界面
![在这里插入图片描述](https://img-blog.csdnimg.cn/2020082309200181.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDQ5MTkyNw==,size_16,color_FFFFFF,t_70#pic_center)

​        我们可以看到，在接口信息配置里，**填写的URL需要正确响应微信发送的Token验证**，所以这个时候我们还不能直接添加URL,需要有一个能够响应微信发送的Token验证的接口才行。

### 2. 创建SpringBoot项目，引入依赖

```xml
	<!--微信公众号-->
    <dependency>
        <groupId>com.github.binarywang</groupId>
        <artifactId>wx-java-mp-spring-boot-starter</artifactId>
        <version>3.6.0</version>
    </dependency>
```

### 3. 添加配置

```yml
wx:  
  mp:
    app-id: wx2cb986e6a6fded0b
    secret: 61684997acc23988fe705479ecc64377
    token: jiao
    aes-key:
```

### 4. 添加参数校验接口

```java
@RestController
@RequestMapping("/api/wx")
@Api(tags = "微信：对接微信模块")
@RequiredArgsConstructor
public class WeChatController {
    private final WxMpService wxMpService;

    /**
     * 功能描述： 签名校验
     *
     * @param
     * @author jiaoqianjin
     * Date: 2020/8/19 9:57
     */
    @AnonymousAccess
    @GetMapping("/check")
    @ApiOperation(value = "签名校验", notes = "签名校验；\n author：焦前进")
    public String check(String signature, String timestamp, String nonce, String echostr) throws Exception {
        if (!wxMpService.checkSignature(timestamp, nonce, signature)) {
            // 消息签名不正确，说明不是公众平台发过来的消息
            return null;
        }
        // 消息合法
        return echostr;
    }
```

### 5.  使参数校验接口能够外网访问

![image-20200925151139607](https://gitee.com/jiao_qianjin/zhishiku/raw/master/img/20200925155427.png)

大家可以将项目部署到服务器上，或者使用内网穿透，使校验接口（api/wx/check）可以被访问。开发者通过检验signature对请求进行校验。若确认此次GET请求来自微信服务器，请原样返回echostr参数内容，则接入生效，成为开发者成功，否则接入失败。

### 6. 配置接口配置信息

![image-20200925152028192](https://gitee.com/jiao_qianjin/zhishiku/raw/master/img/20200925155420.png)

**点击提交，是不是成功了呢**

## 3. 插入去重

**表要求：有PrimaryKey，或者unique索引**
**结果：表id都会自增**

```sql
CREATE TABLE names(
    id INT(10) PRIMARY KEY AUTO_INCREMENT,
    class_id INT(10),
    name VARCHAR(255) UNIQUE,
    score INT(10),
    gender VARCHAR(255),
)
```



##### 1. 插入或替换

如果我们希望插入一条新记录（INSERT），但如果记录已经存在，就先删除原记录，再插入新记录。此时，可以使用`REPLACE`语句，这样就不必先查询，再决定是否先删除再插入：

```sql
REPLACE INTO students (id, class_id, name, gender, score) VALUES (1, 1, '小明', 'F', 99);
```

若`id=1`的记录不存在，`REPLACE`语句将插入新记录，否则，当前`id=1`的记录将被删除，然后再插入新记录。

##### 2. 插入或更新

如果我们希望插入一条新记录（INSERT），但如果记录已经存在，就更新该记录，此时，可以使用`INSERT INTO ... ON DUPLICATE KEY UPDATE ...`语句：

```sql
INSERT INTO students (id, class_id, name, gender, score) VALUES (1, 1, '小明', 'F', 99) ON DUPLICATE KEY UPDATE name='小明', gender='F', score=99;
```

若`id=1`的记录不存在，`INSERT`语句将插入新记录，否则，当前`id=1`的记录将被更新，更新的字段由`UPDATE`指定。

##### 3. 插入或忽略

如果我们希望插入一条新记录（INSERT），但如果记录已经存在，就啥事也不干直接忽略，此时，可以使用`INSERT IGNORE INTO ...`语句：

```sql
INSERT IGNORE INTO students (id, class_id, name, gender, score) VALUES (1, 1, '小明', 'F', 99);
```

若`id=1`的记录不存在，`INSERT`语句将插入新记录，否则，不执行任何操作。

## 4. rabbitMQ 消费者消费消息失败，会一直重复发送



## 5.  只用一条sql语句，如何查出一个表里，不同条件对应的数据条数



## 6. swagger 分组



## 7. mybatis-plus 自定义分页+条件构造器 



## 8.  java data 相关时间格式转换



## 9. java stream







